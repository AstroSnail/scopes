Original code by Leonard Ritter.

With contributions from

* Rys Sommefeldt
* James Austin
* Matt Keeter
